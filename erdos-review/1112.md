# Review: Erdos Problem 1112

**Problem:** Lacunary sequences and sumset avoidance
**Source:** [erdosproblems.com/1112](https://www.erdosproblems.com/1112)
**Status:** OPEN

## Source Problem

Let 1 <= d_1 < d_2 and k >= 3. Does there exist an integer r such that if B = {b_1 < b_2 < ...} is a lacunary sequence with b_{i+1} >= r * b_i, then there exists a sequence A = {a_1 < a_2 < ...} satisfying:

1. d_1 <= a_{i+1} - a_i <= d_2 for all i >= 1 (consecutive differences are bounded)
2. (kA) intersect B = empty (the k-fold sumset of A avoids B)

Known: r_2(2,3) = 2 exists, r_3(2,3) does not exist. The existence of r_k(a,b) for k >= 3 remains open.

## Current Formalization

```lean
/-- k-fold sumset: sums of k elements from A -/
def kSumset (k : ℕ) (A : Set ℕ) : Set ℕ :=
  {n | ∃ (s : Finset ℕ), (s : Set ℕ) ⊆ A ∧ s.card = k ∧ s.sum id = n}

/-- Does there exist r (depending on d₁, d₂, k) such that for all lacunary sequences B
    with ratio >= r, there exists a sequence A with bounded gaps whose k-fold sumset avoids B -/
@[category research open, AMS 11]
theorem lacunary_sumset_avoidance (d₁ d₂ : ℕ) (hd : 1 ≤ d₁ ∧ d₁ < d₂) (k : ℕ) (hk : 3 ≤ k) :
    answer(sorry) ↔
      ∃ (r : ℕ), ∀ (B : ℕ → ℕ),
        (∀ i, B (i + 1) ≥ r * B i) →
        ∃ (A : ℕ → ℕ), StrictMono A ∧
          (∀ i, d₁ ≤ A (i + 1) - A i ∧ A (i + 1) - A i ≤ d₂) ∧
          Disjoint (kSumset k (Set.range A)) (Set.range B) := by
  sorry
```

## Critical Analysis

### 1. Overall structure is correct (GOOD)

The quantifier structure matches the source: for given d_1, d_2, k, does there exist r such that for all lacunary B with ratio >= r, there exists A with bounded gaps whose k-fold sumset avoids B? The `answer(sorry)` is appropriate since this is a yes/no open question.

### 2. Lacunary condition is correct (GOOD)

`∀ i, B (i + 1) ≥ r * B i` correctly captures that B is lacunary with ratio at least r. The source has b_{i+1} >= r * b_i, which is exactly this.

### 3. Bounded gap condition is correct (GOOD)

`∀ i, d₁ ≤ A (i + 1) - A i ∧ A (i + 1) - A i ≤ d₂` correctly requires consecutive differences to be between d_1 and d_2. Combined with `StrictMono A`, this ensures A is an increasing sequence with controlled gaps.

### 4. kSumset definition has a subtle issue (MODERATE)

The definition `kSumset k A = {n | ∃ (s : Finset ℕ), (s : Set ℕ) ⊆ A ∧ s.card = k ∧ s.sum id = n}` defines the k-fold sumset as sums of k *distinct* elements from A (since Finset elements are distinct). The standard definition of kA in additive combinatorics is the set of all sums a_{i_1} + a_{i_2} + ... + a_{i_k} where the a_{i_j} are elements of A (with repetition allowed). Using distinct elements (Finset) vs. allowing repetition (Multiset) changes the sumset.

For the source problem, kA typically means {a_{i_1} + ... + a_{i_k} : a_{i_j} in A}, which allows repeated elements. The formalization uses a Finset, which forces distinctness. This could be a meaningful difference: if A = {1, 2, 3, ...}, then 3 = 1+1+1 is in 3A (with repetition) but 3 cannot be written as a sum of 3 distinct elements from A with sum 3 (the only option would be {0,1,2} but 0 is not necessarily in A).

However, for the avoidance problem, using distinct elements gives a *smaller* kSumset, making the avoidance condition easier to satisfy. If the source intends the standard k-fold sumset (with repetition), the formalization's version is weaker.

### 5. Bounded gap condition in ℕ subtraction (MODERATE concern)

The expression `A (i + 1) - A i` uses natural number subtraction. Since `StrictMono A` ensures `A (i + 1) > A i`, the subtraction does not underflow. However, the condition `d₁ ≤ A (i + 1) - A i` combined with `hd : 1 ≤ d₁` ensures the gap is at least 1, which is consistent with strict monotonicity. This is fine.

### 6. Disjointness formulation is correct (GOOD)

`Disjoint (kSumset k (Set.range A)) (Set.range B)` correctly states that the k-fold sumset of the range of A is disjoint from the range of B, matching (kA) ∩ B = ∅.

### 7. Parameters d_1, d_2 as ℕ (MINOR)

The source says 1 <= d_1 < d_2 with d_1, d_2 integers. Using ℕ is appropriate since they are positive integers.

### 8. B is an arbitrary sequence, not necessarily strictly increasing (MINOR)

The source says B = {b_1 < b_2 < ...}, i.e., B is strictly increasing. The formalization has `B : ℕ → ℕ` with `∀ i, B (i + 1) ≥ r * B i`. For r >= 2, the lacunary condition already implies strict monotonicity (as long as B(0) > 0). For r = 1, B could be constant. But since r is existentially quantified and the interesting case has r >= 2, this is not a practical issue. Adding `StrictMono B` would be slightly more faithful but is implied by the lacunary condition for r >= 2.

### 9. The answer(sorry) pattern usage is appropriate (GOOD)

Since the problem is open (the existence of r_k(a,b) for k >= 3 is unknown) and the answer depends on the specific parameters, using `answer(sorry)` with parameters d_1, d_2, k is correct.

### 10. Known results for k=2 not captured (MINOR)

The source mentions that r_2(2,3) = 2 (exists) and r_3(2,3) does not exist. These could be separate theorems but their absence from the formalization is not a major issue since the main open question is for k >= 3.

## What a proper formalization would look like

The current formalization is close to ideal. The main improvement would be to fix the kSumset definition to allow repeated elements:

```lean
/-- k-fold sumset: sums of k elements from A (with repetition) -/
def kSumset (k : ℕ) (A : Set ℕ) : Set ℕ :=
  {n | ∃ (f : Fin k → ℕ), (∀ i, f i ∈ A) ∧ (Finset.univ.sum f = n)}

-- The rest of the formalization is already correct.
```

Alternatively, if the distinct-elements interpretation is intended:

```lean
-- The current definition using Finset is correct for this interpretation.
-- Add a comment clarifying the distinct-element choice.
```

## Confidence: **80%**

The rewritten formalization is a dramatic improvement over the original. The quantifier structure, roles of A and B, lacunary condition, bounded gap condition, and disjointness conclusion all match the source. The main concern is the kSumset definition using distinct elements (Finset) rather than allowing repetition, which changes the mathematical content of the k-fold sumset. This is a moderate issue since the standard definition of kA allows repetition. The formalization with distinct elements gives a weaker statement (smaller sumset, easier to avoid). All other aspects are correct and well-structured.
