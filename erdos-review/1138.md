# Review: Erdos Problem 1138

**Problem:** Asymptotic formula for primes in intervals near maximum gaps
**Source:** [erdosproblems.com/1138](https://www.erdosproblems.com/1138)
**Status:** OPEN

## Source Problem

Let x/2 < y < x and C > 1. If d = max_{p_n < x} (p_{n+1} - p_n) denotes the maximum prime gap below x, is it true that:

  pi(y + Cd) - pi(y) ~ Cd / log y

as x -> infinity?

## Current Formalization

```lean
/-- Prime counting function -/
noncomputable def primePi (x : ‚Ñù) : ‚Ñï := sorry

/-- Maximum prime gap below x -/
noncomputable def d (x : ‚Ñù) : ‚Ñï := sorry

/-- Asymptotic formula for primes near maximum gaps -/
@[category research open, AMS 11]
theorem primes_near_max_gaps (C : ‚Ñù) (hC : 1 < C) (x y : ‚Ñù) (hxy1 : x / 2 < y) (hxy2 : y < x) :
    Tendsto (fun _ : ‚Ñï => ((primePi (y + C * d x) : ‚Ñù) - (primePi y : ‚Ñù)) / (((C * d x) : ‚Ñù) / Real.log y)) atTop (ùìù 1) := by
  sorry
```

## Critical Analysis

### 1. Variables x, y are fixed, not varying (CRITICAL)

The source asks about an asymptotic statement as x -> infinity, with y depending on x (satisfying x/2 < y < x). The formalization takes x and y as **fixed parameters** and then applies `Tendsto (fun _ : ‚Ñï => ...) atTop (ùìù 1)`. Since the function ignores its argument (uses `_ : ‚Ñï`), this is asserting that a **constant** function tends to 1, which is equivalent to saying the constant equals 1 exactly. This is not an asymptotic statement at all.

### 2. Missing quantification over y (CRITICAL)

The asymptotic statement should hold **for all** y in the range (x/2, x) simultaneously as x -> infinity. The formalization fixes a single y, losing the uniformity.

### 3. Correct structure for the ratio (MODERATE positive)

The ratio `(pi(y + Cd) - pi(y)) / (Cd / log y)` is correctly formed. If x and y were properly quantified, this would be the right expression.

### 4. Opaque definitions (MODERATE)

Both `primePi` and `d` are defined as `sorry`. Mathlib has `Nat.primeCounting` for pi(x), and `d(x)` should be the maximum gap below x. Without proper definitions, the theorem is vacuous.

### 5. Should use answer elaborator (MODERATE)

This is an open yes/no problem that should use `answer(sorry) ‚Üî ...`.

### 6. d should depend on x as it varies (CRITICAL)

In the asymptotic formulation, d = d(x) = max prime gap below x, which changes as x grows. Since x is fixed in the formalization, d(x) is a single fixed number.

## What a proper formalization would look like

```lean
theorem primes_near_max_gaps (C : ‚Ñù) (hC : 1 < C) :
    answer(sorry) ‚Üî
      ‚àÄ (y : ‚Ñù ‚Üí ‚Ñù), (‚àÄ·∂† x in atTop, x / 2 < y x ‚àß y x < x) ‚Üí
        Tendsto (fun x : ‚Ñù =>
          ((Nat.primeCounting ‚åäy x + C * d x‚åã‚Çä : ‚Ñù) -
           (Nat.primeCounting ‚åäy x‚åã‚Çä : ‚Ñù)) /
          (C * (d x : ‚Ñù) / Real.log (y x))) atTop (ùìù 1) := by
  sorry
```

## Confidence: **10%**

The formalization has the correct ratio structure and correctly identifies the key quantities (pi, d, C, the interval constraints). However, the critical flaw is that x and y are fixed parameters rather than varying quantities, making the Tendsto statement trivially asserting a constant equals 1. The asymptotic nature of the problem is entirely lost. Additionally, both key definitions are opaque sorry values and the answer elaborator is missing.
