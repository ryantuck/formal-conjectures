# Review: Erdos Problem 1161

**File:** `FormalConjectures/ErdosProblems/1161.lean`
**Source:** [erdosproblems.com/1161](https://www.erdosproblems.com/1161)
**Status:** SOLVED (Beker, 2025)

## Original Problem

Let $f_k(n)$ denote the count of elements in $S_n$ having order $k$. Determine which values of $k$ maximize $f_k(n)$.

Beker proved:
1. $\max_{k \geq 1} f_k(n) \sim (n-1)!$
2. For sufficiently large $n$, if $f_k(n) \geq (n-1)!$, then $\text{lcm}(1, \ldots, n-k) \mid k$
3. For all large $n$, $f_k(n) = (n-1)!$ iff $k$ is minimal satisfying $\text{lcm}(1, \ldots, n-k) \mid k$

## Current Formalization

```lean
theorem maximal_order_elements_characterization :
    answer(True) ↔
      ∃ (f : ℕ → ℕ → ℕ) (k_min : ℕ → ℕ) (N : ℕ), ∀ n ≥ N,
        (∀ k : ℕ, f k n ≤ (n - 1).factorial) ∧
        (f (k_min n) n = (n - 1).factorial) ∧
        (∀ k < k_min n, f k n < (n - 1).factorial) := by
  sorry
```

## Analysis

### What the formalization captures

| Aspect | Captured? | Notes |
|--------|-----------|-------|
| Question format | Yes | `answer(True)` for solved problem |
| Upper bound $(n-1)!$ | Yes | `f k n ≤ (n - 1).factorial` |
| Achievement at $k_{\min}$ | Yes | `f (k_min n) n = (n - 1).factorial` |
| Strict sub-optimality below $k_{\min}$ | Yes | `∀ k < k_min n, f k n < (n - 1).factorial` |
| "For sufficiently large $n$" | Yes | `∃ N, ∀ n ≥ N` |
| Category/AMS tag | Yes | `@[category research solved, AMS 20]` |

### Critical issues

1. **Trivially true (Critical):** Take $f(k, n) = 0$ for $k < 1$, $f(k, n) = (n-1)!$ for $k \geq 1$, $k_{\min}(n) = 1$, $N = 2$. All three conditions are satisfied. The existential over $f$ and $k_{\min}$ makes the statement vacuous.

2. **f_k(n) is a specific function, not existential:** $f_k(n) = |\{\sigma \in S_n : \text{ord}(\sigma) = k\}|$ is a well-defined quantity. Lean/Mathlib has `Equiv.Perm (Fin n)` and `orderOf`, so defining this count is feasible.

3. **Missing the lcm characterization of $k_{\min}$:** Beker's key result is that $k_{\min}(n)$ is the minimal $k$ with $\text{lcm}(1, \ldots, n-k) \mid k$. The formalization defines $k_{\min}$ only through the ordering of $f$ values, not through the lcm divisibility condition. This is the most mathematically significant part of the result.

4. **Missing asymptotic equivalence:** Result 1 says $\max_k f_k(n) \sim (n-1)!$, meaning the ratio tends to 1. The formalization says the max equals $(n-1)!$ exactly, which is a stronger claim that happens to be true for large $n$ but doesn't capture the asymptotic nature.

## Verdict

**Confidence: 10%**

The structural skeleton (upper bound, achievement, strict sub-optimality) is correct, but the statement is trivially satisfiable via the existential. The core mathematical content — the lcm characterization $\text{lcm}(1, \ldots, n-k) \mid k$ — is absent.
