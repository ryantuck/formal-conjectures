# Style Review: Erdős Problem 1179

**File:** `FormalConjectures/ErdosProblems/1179.lean`
**Review Date:** 2026-02-11
**Reviewer:** Claude Sonnet 4.5

## Summary

Problem 1179 has several style guideline violations that need to be addressed. The most critical issue is using the wrong format for a question-based problem and improper use of `sorry` embedded in formulas.

**Overall Score:** 10/21 items passing

## Detailed Checklist

### ✅ File Structure & Organization (3/3)

- [x] **1. One problem per file** - ✅ PASS
- [x] **2. Correct directory structure** - ✅ PASS - Located in `FormalConjectures/ErdosProblems/`
- [x] **3. Copyright header present** - ✅ PASS - Correct 2026 format

### ❌ Problem Statement Format (1/3)

- [x] **4. Uses `theorem` or `lemma` keyword** - ✅ PASS - Uses `theorem`
- [ ] **5. Question format** - ❌ **CRITICAL FAILURE**

  **Issue:** The original problem asks: *"Is it true that g_ε(N) = (1+o(1))log₂ N?"*

  This is a question, so according to style guidelines (README line 226-236), it should use:
  ```lean
  theorem name : answer(sorry) ↔ P := by sorry
  ```

  **Current (incorrect):**
  ```lean
  theorem subset_sum_function_estimation (ε : ℝ) (hε : 0 < ε) (hε1 : ε < 1) :
      ∃ (g : ℕ → ℕ),
        ∀ᶠ N in atTop, g N = (1 + sorry) * Real.log N / Real.log 2 := by
    sorry
  ```

  **Should be:**
  ```lean
  theorem subset_sum_function_estimation :
      answer(sorry) ↔
        ∀ ε : ℝ, 0 < ε → ε < 1 →
        ∃ (g_ε : ℕ → ℕ),
          ∀ᶠ N in atTop, g_ε N = (1 + answer(sorry)) * Real.log N / Real.log 2 := by
    sorry
  ```

- [x] **6. Statement format** - N/A (should be question format)

### ✅ Attributes & Tags (3/3)

- [x] **7. `@[category]` attribute present** - ✅ PASS - Has `research solved`
- [x] **8. `@[AMS]` attribute present** - ✅ PASS - Has `AMS 11`

  ⚠️ **Minor concern:** Problem is tagged "Additive combinatorics, Probability" on erdosproblems.com. AMS 11 (Number Theory) may be appropriate, but consider also:
  - AMS 05 (Combinatorics)
  - AMS 60 (Probability theory)

- [x] **9. Both attributes on same theorem** - ✅ PASS - `@[category research solved, AMS 11]`

### ⚠️ Documentation & References (2/4)

- [x] **10. File docstring present** - ✅ PASS - Has module-level `/-! ... -/`
- [x] **11. Reference URL included** - ✅ PASS - Links to erdosproblems.com/1179
- [ ] **12. Problem description** - ⚠️ **NEEDS IMPROVEMENT**

  **Current:** "Subset sum function estimation."

  **Issue:** Too brief. Doesn't explain what g_ε(N) represents, what F_A is, or the probability condition.

  **Suggested improvement:**
  ```lean
  /-!
  # Erdős Problem 1179

  Estimation of g_ε(N), the minimal subset size k needed for subset sum
  distribution to approximate uniform distribution in random abelian groups.

  For abelian group G of size N and random subset A of size k, let
  F_A(g) = #{S ⊆ A : g = ∑_{x∈S} x}. The question asks: is it true that
  g_ε(N) = (1 + o(1)) log₂ N for all ε > 0?

  PROVED - Erdős-Hall bound: g_ε(N) ≤ (1 + O(log log log N / log log N)) log₂ N

  *Reference:* [erdosproblems.com/1179](https://www.erdosproblems.com/1179)
  -/
  ```

- [ ] **13. Theorem docstring** - ⚠️ **NEEDS IMPROVEMENT**

  **Current:** `/-- Subset sum function estimation in abelian groups -/`

  **Issue:** Too brief. Should explain the convergence condition and what g_ε represents.

### N/A Definitions & API (0/2)

- [ ] **14-15. Bespoke definitions** - N/A - No custom definitions used

### ✅ Code Quality (2/3)

- [ ] **16. Code builds** - ❓ **NEEDS VERIFICATION**

  Need to run: `lake build FormalConjectures/ErdosProblems/1179.lean`

  Expected to fail due to `sorry` in formula position.

- [x] **17. Import structure** - ✅ PASS - Uses `import FormalConjectures.Util.ProblemImports`
- [x] **18. Namespace usage** - ✅ PASS - Wrapped in `namespace Erdos1179`

### ❌ Answer Elaborator Usage (0/3)

- [ ] **19. `answer(sorry)` for unknowns** - ❌ **CRITICAL FAILURE**

  **Issue:** Uses bare `sorry` embedded in formula: `(1 + sorry) * Real.log N`

  **Rule violation:** Style guide states to use `answer(sorry)` for unknown values, not bare `sorry`.

  **Current (incorrect):**
  ```lean
  g N = (1 + sorry) * Real.log N / Real.log 2
  ```

  **Should be:**
  ```lean
  g N = (1 + answer(sorry)) * Real.log N / Real.log 2
  ```
  Or better, capture the entire unknown relationship as the answer to the question.

- [ ] **20. `answer(True/False)` for solved** - N/A (would apply if question format used)
- [ ] **21. Correct answer position** - ❌ FAIL - `sorry` in wrong position

## Additional Issues

### Unused Parameters
The theorem declares parameters `(ε : ℝ) (hε : 0 < ε) (hε1 : ε < 1)` but never uses them in the statement. This is suspicious and suggests the formalization may not correctly capture the problem.

### Missing Problem Structure
The actual problem defines:
- g_ε(N) as the **minimal** k with a specific property
- F_A(g) = #{S ⊆ A : g = ∑_{x∈S} x}
- A probability condition with convergence as N → ∞

The current formalization only asserts existence of some function g, without:
- The minimality condition
- The definition of F_A
- The probability/convergence condition

## Recommendations

### Priority 1: Critical Fixes

1. **Reformat as question** - Use `answer(sorry) ↔ P` format since problem asks "Is it true that...?"
2. **Fix sorry usage** - Replace embedded `sorry` with `answer(sorry)` or restructure statement
3. **Add proper problem definition** - Define g_ε(N) with its minimality condition

### Priority 2: Improvements

4. **Expand documentation** - Add fuller explanation of F_A, probability condition, and known bounds
5. **Expand theorem docstring** - Explain what the statement means mathematically
6. **Consider AMS codes** - Possibly add AMS 05 or 60 alongside or instead of 11

### Priority 3: Nice to Have

7. **Verify build** - Confirm the file compiles successfully
8. **Add definition of F_A** - Consider adding bespoke definition with basic API

## Proposed Corrected Version

```lean
/-
Copyright 2026 The Formal Conjectures Authors.
[... standard header ...]
-/

import FormalConjectures.Util.ProblemImports

/-!
# Erdős Problem 1179

Estimation of g_ε(N), the minimal subset size for subset sum uniformity.

Let G be an abelian group of size N, A ⊆ G a random subset of size k, and
F_A(g) = #{S ⊆ A : g = ∑_{x∈S} x}. Define g_ε(N) as the minimal k such that
with probability → 1 as N → ∞:
  |F_A(g) - 2^k/N| ≤ ε · 2^k/N  for all g ∈ G.

Main question: Is g_ε(N) = (1 + o(1)) log₂ N for all ε > 0?

PROVED - Erdős-Hall: g_ε(N) ≤ (1 + O(log log log N / log log N)) log₂ N

*Reference:* [erdosproblems.com/1179](https://www.erdosproblems.com/1179)
-/

open Finset Filter Asymptotics

open scoped Topology Real

namespace Erdos1179

/-- For all ε ∈ (0,1), is it true that the minimal subset size g_ε(N) needed
    for subset sum distribution to be ε-close to uniform satisfies
    g_ε(N) = (1 + o(1)) log₂ N?

    Erdős-Hall proved the upper bound g_ε(N) ≤ (1 + O(log log log N / log log N)) log₂ N,
    confirming this is true. -/
@[category research solved, AMS 11]
theorem subset_sum_asymptotic_estimate :
    answer(True) ↔
      ∀ ε : ℝ, 0 < ε → ε < 1 →
        ∃ (g_ε : ℕ → ℕ),
          (fun N => (g_ε N : ℝ)) ~[atTop] (fun N => Real.log N / Real.log 2) := by
  sorry

end Erdos1179
```

## Conclusion

Problem 1179 requires significant revision to meet style guidelines. The most critical issues are:
1. Using statement format instead of question format
2. Improper use of `sorry` in formula position
3. Incomplete problem formalization

**Recommendation:** Refactor according to suggestions above before merging.
